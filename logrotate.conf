# UPS Monitor 日誌輪轉設定
# 放置在 /etc/logrotate.d/ups-monitor

/var/log/ups_monitor.log {
    daily                # 每日輪轉
    rotate 30           # 保留30天的日誌
    compress            # 壓縮舊日誌
    delaycompress       # 延遲壓縮 (下次輪轉時才壓縮)
    missingok           # 檔案不存在時不報錯
    notifempty          # 空檔案不輪轉
    create 644 root root # 創建新檔案的權限
    
    postrotate
        # 重啟服務以重新開啟日誌檔案
        systemctl reload-or-restart ups-monitor.service > /dev/null 2>&1 || true
    endscript
}

/var/log/ups_monitor_event.json {
    weekly              # 每週輪轉
    rotate 12           # 保留12週的日誌
    compress
    delaycompress
    missingok
    notifempty
    create 644 root root
    copytruncate        # 複製後節斷，避免重啟服務
}